#set global $page = "index"

<!DOCTYPE html>
<html lang="it">
  #include "templates/head.html.tmpl"
  <body class="bg-weather-bg">
    <!-- Header -->
    <div id="header" class="px-8 pt-6 bg-weather-cool/80">
      <div
        class="lg:max-w-[75%] mx-auto text-left relative z-10 text-white"
      >
        <div class="flex items-center gap-3 mb-2">
          <a href="$Extras.web_url">
            <h1 class="text-4xl font-semibold tracking-tight">
              $station.location
            </h1>
          </a>
        </div>

        <div
          class="flex flex-wrap items-center gap-2 mb-2 text-sm text-white/85 font-medium"
        >
          <div class="flex items-center gap-1.5">
            <svg
              class="w-3.5 h-3.5 opacity-70"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
              <circle cx="12" cy="10" r="3" />
            </svg>
            <span class="font-mono"
              >$station.latitude[0]°$station.latitude[1]'$station.latitude[2],
              $station.longitude[0]°$station.longitude[1]'$station.longitude[2]</span
            >
          </div>
          <div class="flex items-center gap-1.5">
            <svg
              class="w-3.5 h-3.5 opacity-70"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="17,10 12,15 7,10" />
              <polyline points="19,15 12,22 5,15" />
            </svg>
            <span class="font-mono">$station.altitude</span>
          </div>
        </div>

        <p class="text-base text-white/90 font-medium mb-4">
          Ultimo aggiornamento:
          <span class="font-mono"
            >$current.dateTime $current.dateTime.format("%Z")</span
          >
        </p>

        <div
          class="flex items-end justify-between flex-wrap gap-4"
        >
          <!-- PC menu -->
          <nav class="flex-1">
            <div class="hidden md:flex flex-row gap-1">
              <a
                href="index.html"
                class="px-3 py-2 text-white text-lg font-medium border-b-2 border-white/80 transition-colors hover:bg-white/10 rounded-t-md"
                >Oggi</a
              >
              <a
                href="week.html"
                class="px-3 py-2 text-white/80 text-lg transition-colors hover:text-white hover:bg-white/10 rounded-t-md"
                >Settimana</a
              >
              <a
                href="month.html"
                class="px-3 py-2 text-white/80 text-lg transition-colors hover:text-white hover:bg-white/10 rounded-t-md"
                >Mese</a
              >
              <a
                href="year.html"
                class="px-3 py-2 text-white/80 text-lg transition-colors hover:text-white hover:bg-white/10 rounded-t-md"
                >Anno</a
              >
              <a
                href="summary.html"
                class="px-3 py-2 text-white/80 text-lg transition-colors hover:text-white hover:bg-white/10 rounded-t-md"
                >Storico</a
              >
              <a
                href="vaia.html"
                class="px-3 py-2 text-white/80 text-lg transition-colors hover:text-white hover:bg-white/10 rounded-t-md"
                >Vaia</a
              >
            </div>
            <!-- Mobile menu button -->
            <div class="md:hidden">
              <button
                class="outline-none mobile-menu-button p-2 rounded-lg hover:bg-white/10 transition-colors"
              >
                <svg
                  class="w-6 h-6 text-white"
                  x-show="!showMenu"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
              </button>
            </div>
          </nav>

          <!-- IG e aduepassi -->
          <div class="flex items-center gap-3">
            <a
              href="https://www.instagram.com/meteocentrocadore/?hl=it"
              class="p-2 text-white/80 text-xl transition-colors hover:text-white hover:bg-white/10 rounded-lg"
              ><i class="fab fa-instagram"></i
            ></a>
            <a
              data-umami-event="A due passi"
              href="https://aduepassidallaciclabile.it"
              class="bg-lime-400 text-gray-900 rounded-full px-4 py-2 text-sm font-medium transition-all hover:bg-lime-300 hover:shadow-lg shadow-lime-500/25"
            >
              <i class="fa-brands fa-airbnb mr-1.5"></i> A due passi dalla
              ciclabile
            </a>
          </div>
        </div>

        <!-- Mobile menu -->
        <div
          class="hidden mobile-menu mt-4 pt-4 border-t border-white/20"
        >
          <ul class="space-y-1">
            <li>
              <a
                href="index.html"
                class="block px-3 py-3 text-white text-lg bg-white/10 rounded-lg font-medium"
                >Oggi</a
              >
            </li>
            <li>
              <a
                href="week.html"
                class="block px-3 py-3 text-white/80 text-lg rounded-lg transition-colors hover:text-white hover:bg-white/10"
                >Settimana</a
              >
            </li>
            <li>
              <a
                href="month.html"
                class="block px-3 py-3 text-white/80 text-lg rounded-lg transition-colors hover:text-white hover:bg-white/10"
                >Mese</a
              >
            </li>
            <li>
              <a
                href="year.html"
                class="block px-3 py-3 text-white/80 text-lg rounded-lg transition-colors hover:text-white hover:bg-white/10"
                >Anno</a
              >
            </li>
            <li>
              <a
                href="summary.html"
                class="block px-3 py-3 text-white/80 text-lg rounded-lg transition-colors hover:text-white hover:bg-white/10"
                >Storico</a
              >
            </li>
            <li>
              <a
                href="vaia.html"
                class="block px-3 py-3 text-white/80 text-lg rounded-lg transition-colors hover:text-white hover:bg-white/10"
                >Vaia</a
              >
            </li>
          </ul>
        </div>
      </div>
    </div>
    <!-- End header -->
    <main class="mx-4">
      <div class="container mx-auto">
        <p id="freshweather"></p>
          <script>
            window.onload = checkDiff("$current.dateTime.format('%m/%d/%Y %I:%M:%S %p (%Z)')");
          </script>
        <!-- Mqtt -->
        <div class="mb-4 mt-4">
          <div
            class="online-indicator mx-7 mt-1.5 md:ml-0"
            id="indicator"
          >
            <span
              class="w-2 h-2 bg-red-500 rounded-full animate-pulse"
              id="indicator-1"
            ></span>

          </div>
          <p id="mqttStatus" class="inline-block align-middle mb-1"
            >Connessione alla stazione meteo in corso...</p
          >
        </div>

        <section class="mb-4">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <div class="lg:col-span-1">
              <!-- <div class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100 mb-4">
                <span>
                    #if ($current.outTemp.raw - $day.outTemp.avg($days_ago=1).raw) > 1.0
                        Temperature superiori rispetto a ieri
                    #elif ($day.outTemp.avg($days_ago=1).raw - $current.outTemp.raw) > 1.0
                        Temperature inferiori rispetto a ieri
                    #else
                        Temperature simili a ieri
                    #end if
                </span>
                <span>
                    #if $trend.outTemp.raw > 0.05
                        e attualmente in aumento.
                    #elif $trend.outTemp.raw < -0.05
                        e attualmente in calo.
                    #else
                        e attualmente stabili.
                    #end if
                </span>
                <span>
                    #if $current.rainRate.raw > 0
                        Sta piovendo.
                    #elif $day.rain.sum.raw > 0
                        Ha piovuto.
                    #else
                        Non ha piovuto.
                    #end if
                </span>
              </div> -->
              <div
                class="grid grid-cols-2 lg:grid-cols-3 gap-4 mb-4"
              >
                <!-- Tempeartura -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">Temperatura</div>
                  </div>
                  <div
                    class="text-2xl font-bold text-gray-800 mb-2"
                    id="outTemp"
                  >
                    $current.outTemp
                  </div>
                  <div class="text-s text-gray-500 mb-2">
                    Percepita:
                    <span class="" id="heatIndex"
                      >$current.appTemp</span
                    >
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      Max:
                      <span class="font-medium"
                        >$day.outTemp.max</span
                      >
                      <span class="text-gray-400"
                        >($day.outTemp.maxtime.format("%H:%M"))</span
                      >
                    </div>
                    <div>
                      Min:
                      <span class="font-medium"
                        >$day.outTemp.min</span
                      >
                      <span class="text-gray-400"
                        >($day.outTemp.mintime.format("%H:%M"))</span
                      >
                    </div>
                  </div>
                </div>
                <!-- umidità -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">Umidità</div>
                  </div>
                  <div
                    class="text-2xl font-bold text-gray-800 mb-2"
                    id="outHum"
                  >
                    $current.outHumidity
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      Max:
                      <span class="font-medium"
                        >$day.outHumidity.max</span
                      >
                      <span class="text-gray-400"
                        >($day.outHumidity.maxtime.format("%H:%M"))</span
                      >
                    </div>
                    <div>
                      Min:
                      <span class="font-medium"
                        >$day.outHumidity.min</span
                      >
                      <span class="text-gray-400"
                        >($day.outHumidity.mintime.format("%H:%M"))</span
                      >
                    </div>
                  </div>
                </div>

                <!-- Pressione -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">Pressione</div>
                  </div>
                  <div
                    class="text-2xl font-bold text-gray-800"
                    id="pressure"
                  >
                    $current.barometer
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      Max:
                      <span class="font-medium"
                        >$day.barometer.max</span
                      >
                      <span class="text-gray-400"
                        >($day.barometer.maxtime.format("%H:%M"))</span
                      >
                    </div>
                    <div>
                      Min:
                      <span class="font-medium"
                        >$day.barometer.min</span
                      >
                      <span class="text-gray-400"
                        >($day.barometer.mintime.format("%H:%M"))</span
                      >
                    </div>
                  </div>
                </div>

                <!-- Vento -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">Vento</div>
                  </div>
                  <div
                    class="text-2xl font-bold text-grey-800"
                    id="windSpeed"
                  >
                    $current.windSpeed
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      $current.windDir.ordinal_compass
                    </div>
                    <div>
                      Max:
                      <span class="font-medium"
                        >$day.windGust.max</span
                      >
                      <span class="text-gray-400"
                        >($day.windGust.maxtime.format("%H:%M"))</span
                      >
                    </div>
                    <div>
                      Avg:
                      <span class="font-medium"
                        >$day.windSpeed.avg</span
                      >
                    </div>
                  </div>
                </div>
                <!-- pioggia -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">Pioggia</div>
                  </div>
                  <div
                    class="text-2xl font-bold text-grey-800"
                    id="rain"
                  >
                    $day.rain.sum
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      Rain rate:
                      <span class="font-medium" id="rainRate"
                        >$current.rainRate</span
                      >
                    </div>
                    <div>
                      Rain rate max:
                      <span class="font-medium"
                        >$day.rainRate.max</span
                      >
                    </div>
                  </div>
                </div>

                <!-- Dew Point -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">
                      Punto di rugiada
                    </div>
                    <span class="relative ml-2 group">
                      <i
                        class="fas fa-question-circle text-gray-600 cursor-pointer"
                        tabindex="0"
                        aria-label="Informazioni sul punto di rugiada"
                      ></i>
                      <span
                        class="absolute w-56 bg-gray-800 text-white text-center rounded py-2 px-3 bottom-full left-1/2 transform -translate-x-1/2 mb-2 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition-opacity duration-300 pointer-events-none"
                      >
                        Temperatura alla quale l'aria deve raffreddarsi affinché
                        il vapore acqueo presente inizi a condensare.
                      </span>
                    </span>
                  </div>
                  <div
                    class="text-2xl font-bold text-grey-800"
                    id="dewPoint"
                  >
                    $current.dewpoint
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      Max:
                      <span class="font-medium"
                        >$day.dewpoint.max</span
                      >
                      <span class="text-gray-400"
                        >($day.dewpoint.maxtime.format("%H:%M"))</span
                      >
                    </div>
                    <div>
                      Min:
                      <span class="font-medium"
                        >$day.dewpoint.min</span
                      >
                      <span class="text-gray-400"
                        >($day.dewpoint.mintime.format("%H:%M"))</span
                      >
                    </div>
                  </div>
                </div>

                <!-- Wind Chill -->
                <div
                  class="bg-weather-cool/6 rounded-2xl p-4 border border-gray-100"
                >
                  <div
                    class="flex items-center justify-between mb-2"
                  >
                    <div class="text-sm text-gray-800">Wind Chill</div>
                    <span class="relative ml-2 group">
                      <i
                        class="fas fa-question-circle text-gray-600 cursor-pointer"
                        tabindex="0"
                        aria-label="Informazioni sul punto di rugiada"
                      ></i>
                      <span
                        class="absolute w-56 bg-gray-800 text-white text-center rounded py-2 px-3 bottom-full left-1/2 transform -translate-x-1/2 mb-2 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition-opacity duration-300 pointer-events-none"
                      >
                        Temperatura percepita per effetto del vento sulla pelle.
                      </span>
                    </span>
                  </div>
                  <div
                    class="text-2xl font-bold text-grey-800"
                    id="windChill"
                  >
                    $current.windchill
                  </div>
                  <div class="text-xs text-gray-500 space-y-1">
                    <div>
                      Max:
                      <span class="font-medium"
                        >$day.windchill.max</span
                      >
                      <span class="text-gray-400"
                        >($day.windchill.maxtime.format("%H:%M"))</span
                      >
                    </div>
                    <div>
                      Min:
                      <span class="font-medium"
                        >$day.windchill.min</span
                      >
                      <span class="text-gray-400"
                        >($day.windchill.mintime.format("%H:%M"))</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- webcam -->
            <div class="lg:col-span-1">
              <div
                class="bg-gradient-to-br from-weather-cool/10 to-weather-warm/10 rounded-2xl p-4 flex flex-col"
              >
                <!-- Radio buttons prima del container -->
                <input
                  type="radio"
                  id="webcam"
                  name="weather-view"
                  style="display: none"
                  checked
                />
                <input
                  type="radio"
                  id="radar"
                  name="weather-view"
                  style="display: none"
                />

                <div class="weather-container">
                  <div class="lg:col-span-1">
                    <div class="">
                      <!-- Navigazione -->
                      <div class="mb-3 flex justify-center">
                        <div
                          class="bg-white/20 rounded-lg p-1 flex gap-1"
                        >
                          <label
                            for="webcam"
                            class="webcam-btn px-3 py-1 rounded text-sm font-medium transition-colors cursor-pointer hover:bg-white/20 bg-white/30 text-gray-800"
                          >
                            📹 Webcam
                          </label>
                          <label
                            for="radar"
                            class="radar-btn px-3 py-1 rounded text-sm font-medium transition-colors cursor-pointer hover:bg-white/20 text-gray-600"
                          >
                            🌦️ Radar
                          </label>
                        </div>
                      </div>

                      <!-- Immagini -->
                      <div class="flex-1 overflow-hidden">
                        <img
                          class="webcam-image w-full object-cover block rounded-xl"
                          src="$Extras.webcam_url?$current.dateTime.raw"
                          alt="Live weather camera"
                        />
                        <img
                          class="radar-image w-full object-contain hidden lg:max-h-[25vw] rounded-xl"
                          src="$Extras.radar_url?$current.dateTime.raw"
                          alt="Weather radar"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section>
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            <div
              class="md:col-span-1 bg-weather-cool/6 rounded-2xl border border-gray-100"
            >
              <!-- One year ago -->
              <!--Leap Year Code -->
              <!-- prettier-ignore -->
              #set $yr = int($day.dateTime.format("%Y"))%4
            #if $yr == 0
              #if $yr % 100 == 0
                #if $yr % 400 == 0
                  #if $day.dateTime.format("%d-%b") == '29-Feb'
                    #set $n = 1461
                  #else if $day.dateTime.format("%d-%b") >= '01-Mar'
                    #set $n = 366
                  #else
                    #set $n = 365
                  #end if
                #else
                  #set $n = 365
                #end if
              #else
                #if $day.dateTime.format("%d-%b") == '29-Feb'
                  #set $n = 1461
                #else if $day.dateTime.format("%d-%b") >= '01-Mar'
                  #set $n = 366
                #else
                  #set $n = 365
                #end if
              #end if
            #else
              #set $yrNew = ($yr - 1)
            #if $yrNew % 100 == 0
              #if $yrNew % 400 == 0
                #if $day.dateTime.format("%d-%b") < '01-Mar'
                  #set $n = 366
                #else
                  #set $n = 365
                #end if
              #end if
              #else
                #set $n = 365
              #end if
            #end if
              <!-- prettier-ignore-end -->
              <h1 class="text-xl text-gray-800 px-4 pt-4">
                Un anno fa ($days_ago($days_ago=$n).dateTime.format("%d-%b(%Y)"))
              </h1>

              <table
                class="w-full table-fixed border-collapse mt-2"
              >
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Temperatura massima:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).outTemp.max
                    $days_ago($days_ago=$n).outTemp.maxtime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Temperatura minima:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).outTemp.min
                    $days_ago($days_ago=$n).outTemp.mintime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Umidità massima:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).outHumidity.max
                    $days_ago($days_ago=$n).outHumidity.maxtime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Umidità minima:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).outHumidity.min
                    $days_ago($days_ago=$n).outHumidity.mintime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Pressione massima:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).barometer.max
                    $days_ago($days_ago=$n).barometer.maxtime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Pressione minima:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).barometer.min
                    $days_ago($days_ago=$n).barometer.mintime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Pioggia:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).rain.sum
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                  >
                    Rain Rate max:
                  </td>
                  <td
                    class="py-2 text-gray-900 border-b border-gray-200"
                  >
                    $days_ago($days_ago=$n).rainRate.max
                    $days_ago($days_ago=$n).rainRate.maxtime
                  </td>
                </tr>
                <tr class="hover:bg-weather-cool/5 group">
                  <td
                    class="pr-10 py-2 font-medium text-gray-900 pl-4 group-hover:rounded-bl-2xl"
                  >
                    Vento massimo:
                  </td>
                  <td
                    class="py-2 text-gray-900 group-hover:rounded-br-2xl"
                  >
                    $days_ago($days_ago=$n).wind.max $day.wind.gustdir
                    $days_ago($days_ago=$n).wind.maxtime
                  </td>
                </tr>
              </table>
            </div>

            <!-- Almanac -->
            <div
              class="lg:col-span-2 bg-weather-cool/6 rounded-2xl border border-gray-100"
            >
              <!-- prettier-ignore -->
              #set $sun_altitude = $almanac.sun.alt
              #if $sun_altitude < 0
              #set $sun_None="<i>(Always down)</i>"
              #else
              #set $sun_None="<i>(Always up)</i>"
              #end if
              <!-- prettier-ignore-end -->

              <h1 class="text-xl px-4 pt-4">Almanacco</h1>
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-2">
                <div>
                  <h1 class="text-xl text-gray-800 px-4 pt-4">
                    Sole
                  </h1>

                  <table
                    class="w-full table-fixed border-collapse mt-2"
                  >
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Inizio crepuscolo civile:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac(horizon=-6).sun(use_center=1).rise
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Alba:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.sun.rise.string($sun_None)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Transito:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.sun.transit
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Tramonto:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.sun.set.string($sun_None)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Fine crepuscolo civile:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac(horizon=-6).sun(use_center=1).set
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Azimuth:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.sun.az)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Altitudine:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $sun_altitude)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Ascensione retta:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.sun.ra)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Inclinazione:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.sun.dec)
                      </td>
                    </tr>
                    #if $almanac.next_equinox.raw > $almanac.next_solstice.raw
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Solstizio:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_solstice
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Equinozio:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_equinox
                      </td>
                    </tr>
                    #else
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Equinozio:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_equinox
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5 group">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 pl-4 group-hover:rounded-bl-2xl"
                      >
                        Solstizio:
                      </td>
                      <td
                        class="py-2 text-gray-900 group-hover:rounded-br-2xl"
                      >
                        $almanac.next_solstice
                      </td>
                    </tr>
                    #end if
                  </table>
                </div>

                <div>
                  <h1 class="text-xl text-gray-800 px-4 pt-4">
                    Luna
                  </h1>

                  <table
                    class="w-full table-fixed border-collapse mt-2"
                  >
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Leva:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.moon.rise
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Transito:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.moon.transit
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Cala:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.moon.set
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Azimut:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.moon.az)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Altitudine:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.moon.alt)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Ascensione retta:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.moon.ra)
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Inclinazione:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $("%.1f&deg;" % $almanac.moon.dec)
                      </td>
                    </tr>
                    #if $almanac.next_full_moon.raw < $almanac.next_new_moon.raw
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Luna piena:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_full_moon
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Luna nuova:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_new_moon
                      </td>
                    </tr>
                    #else
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Luna nuova:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_new_moon
                      </td>
                    </tr>
                    <tr class="hover:bg-weather-cool/5">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 border-b border-gray-200 pl-4"
                      >
                        Luna piena:
                      </td>
                      <td
                        class="py-2 text-gray-900 border-b border-gray-200"
                      >
                        $almanac.next_full_moon
                      </td>
                    </tr>
                    #end if
                    <tr class="hover:bg-weather-cool/5 group">
                      <td
                        class="pr-10 py-2 font-medium text-gray-900 pl-4 group-hover:rounded-bl-2xl"
                      >
                        Fase:
                      </td>
                      <td
                        class="py-2 text-gray-900 group-hover:rounded-br-2xl"
                      >
                        $almanac.moon_phase ($almanac.moon_fullness% full)
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </section>

        <hr class="h-px mt-8 mb-8 bg-blue-200 border-0" />

        <!-- Grafici -->
        <div class="mb-4">
          <h1 class="text-xl p-4 md:p-4">
            <i class="fa fa-line-chart m-gruen"></i> Grafici
          </h1>
          <div class="grid grid-cols-1 md:grid-cols-2">
            <div id="outTempChart" class="h-[40vh]"></div>
            <div id="rainChart" class="h-[40vh]"></div>
            <div id="windChart" class="h-[40vh]"></div>
            <div id="windDirChart" class="h-[40vh]"></div>
            <div id="heatIndexChart" class="h-[40vh]"></div>
            <div id="barometerChart" class="h-[40vh]"></div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    #include "templates/footer.html.tmpl"
    <!-- End footer-->

    <script>
      const btn = document.querySelector("button.mobile-menu-button");
      const menu = document.querySelector(".mobile-menu");

      btn.addEventListener("click", () => {
        menu.classList.toggle("hidden");
      });
    </script>
    <script src="./js/eplot.js?v1.3"></script>
  </body>
</html>
